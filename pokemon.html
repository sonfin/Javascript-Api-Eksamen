<!DOCTYPE html>
<html lang="nb">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="pokemon.css" />
    <title>Pokemon | Eksamen</title>
  </head>
  <body>
    <header>
      <nav>
        <!-- http://www.rw-designer.com/cursor-detail/55503 -->
        <button type="button" id="sort-nav-btn">Sorter:</button>
        <h1>Pokemon finner app</h1>
        <button type="button" id="favorites-nav-btn">Favoritter</button>
      </nav>
    </header>
    <main></main>
    <script>
      const sortNavBtn = document.querySelector("#sort-nav-btn");
      const favoritesNavBtn = document.querySelector("#favorites-nav-btn");
      let uniqueNumersArray = [];
      const unique50Pokemon = [];

      // Fetch api's

      let allPokemonArray = [];

      sortNavBtn.onclick = initializeAllPokemon;

      async function getAllPokemons() {
        const pokemonRequest = await fetch(
          "https://pokeapi.co/api/v2/pokemon?limit=100000&offset=0"
        );
        const pokemonResult = await pokemonRequest.json();
        return pokemonResult.results;
      }

      async function initializeAllPokemon() {
        try {
          allPokemonArray = await getAllPokemons();
          uniquePokemon = await uniquePokemon50();
        } catch (error) {
          console.error("Error med å laste innhold", error);
        }
      }

      // Random 50 pokemons

      async function uniquePokemon50() {
        try {
          while (uniqueNumersArray.length < 50) {
            const randomNumber = Math.floor(
              Math.random() * allPokemonArray.length
            );
            if (!uniqueNumersArray.includes(randomNumber)) {
              uniqueNumersArray.push(randomNumber);
            }
          }
          console.log(uniqueNumersArray);
          console.log(allPokemonArray);
          getPokemonInfo();
        } catch (error) {
          console.error("Error med å generere unique pokemon", error);
        }
      }

      const pokeApiUrlArray = [];
      const pokeInfo = [];

      async function getPokemonInfo() {
        uniqueNumersArray.forEach((number) => {
          const pokemon = allPokemonArray[number];
          pokeApiUrlArray.push(pokemon.url);
        });

        try {
          for (const url of pokeApiUrlArray) {
            const response = await fetch(url);
            const pokeInfo = await response.json();
            unique50Pokemon.push(pokeInfo);
            console.log(url, pokeInfo);
          }
        } catch (error) {
          console.error("Error med å hente pokemon api:", error);
        }
      }
    </script>
  </body>
</html>
